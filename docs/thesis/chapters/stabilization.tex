\chapter{Temporal stabilization of clusters}

After clustering, we need to reassign colors to the clusters to stabilize them over time. \\
As mentioned before, the order in which clusters are determined at each moment is random, and the selection order of clusters is represented by a color. Therefore, from the initial random color assignment, we aim to transition to a color assignment where two clusters of the same color share as many nodes (joints) as possible between moments.

This is because the random assignment of colors poses visualization issues for the graph. It's possible that from one moment to the next, two clusters with many shared joints might have different colors, resulting in a visualization over time that appears as a continuous switching of colors. This could lead to a loss of continuity in the visual representation.
To stabilize clusters over time, ensuring that pairs of clusters colored from one moment to another share the highest number of common joints, we turn to the MPWM.

We have implemented two algorithms: a BF approach, where we compute the total weights of all possible permutations of color assignments and select the assignment with the maximum total weight, and the Hungarian Algorithm, a combinatorial optimization method that solves the assignment problem in polynomial time.

Since in our case the number of clusters is usually small, there are instances where the BF is more efficient.

\section{Maximum Perfect Weight Matching for bipartite graphs}
The Maximum Perfect Weight Matching is an optimization problem concerning graphs.
The graphs in question are bipartite, meaning the vertices can be divided into two distinct sets in such a way that all edges of the graph connect vertices from different sets, with no edges connecting vertices within the same set.
Additionally, these graphs are undirected, meaning the relationship between two nodes is bidirectional, in other words, the edge connecting node A to node B automatically implies the existence of the edge connecting node B to node A. \\
In the MPWM problem, the vertices represent elements to be paired, and the edges represent possible connections between these elements. 
Each edge is associated with a weight that represents the value or importance of the pairing between the connected vertices.\\
The goal is to find a perfect matching, which is a set of edges in which every node is connected to exactly one other node, with no overlaps or isolated nodes, while maximizing the total weight of the edges in the matching.
The total weight is the sum of the weights of the edges included in the matching.
The weights of the edges are collected in a matrix called a \textit{utility matrix}.\\
The utility matrix will be a square matrix because the number of nodes in the two distinct sets is the same.
The rows could represent the nodes in the first set, while the columns could represent the nodes in the second set, or vice versa.
The element (\textit{i}, \textit{j}) of the matrix represents the weight of the edge connecting vertex \textit{i} to vertex \textit{j}. 


\subsection{Temporal stabilization}
In our case, instead of having nodes connected by edges, we will have a slightly different situation.
Instead of the previously introduced nodes, we will have clusters, which are sets of nodes representing the joints of the skeleton, connected to each other by edges.\\  
Consider the clusters at time \textit{t} and the clusters at time \textit{t+1} as two distinct sets, so there will be no edges connecting clusters that belong to the same set.
Each cluster in one set must be connected by an edge to exactly one cluster in the other set, with the goal of maximizing the total weight of the edges.
The weight of an edge is equal to the number of nodes that the two clusters it is connecting have in common.\\
As previously mentioned, at this stage of the pipeline, we already have information about the joints belonging to various clusters and the colors of these clusters. However, we want to reassign colors to stabilize the visualization over time.
The previous clustering groups the joints into clusters and assigns them random colors, while in this phase of the pipeline, we optimize the color assignment.\\
We will start by analyzing the colors of the clusters at the initial frame and choose the best color assignment for the next frame.
Then will repeat this process iteratively until the last frame.


\subsection{A real application}
Let's consider a real-world scenario to understand how MPWM works in terms of visualization.
Suppose we have 20 nodes representing joints at time \textit{t} and 3 clusters labeled with different colors, as shown in Figure \ref{fig:clust_t}.
At time \textit{t+1}, there are the same 20 nodes as before but with 3 clusters labeled differently (see Figure \ref{fig:clust_tplus1}). \\
Certainly, this clustering-based assignment cannot be regarded as the optimal assignment, as we still need to assess the \textit{3!} possible color assignments. \\
We know the colors of the clusters at time \textit{t}, and we want to assign colors to the clusters at time \textit{t+1}. \\
In Figure \ref{fig:clust_ass}, you can visually see all the possible color assignments, while in Table \ref{tab:table_clust}, all the values of common nodes for each color and the total weight of the matching are gathered.


\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[circle, draw, minimum size=0.7cm] (1) at (1,-9) [fill=green!50] {1};
    \node[circle, draw, minimum size=0.7cm] (2) at (9, -9) [fill=green!50] {2};
    \node[circle, draw, minimum size=0.7cm] (3) at (2.5,-8.5) [fill=green!50] {3};
    \node[circle, draw, minimum size=0.7cm] (4) at (7.5, -8.5) [fill=green!50] {4};
    \node[circle, draw, minimum size=0.7cm] (5) at (3,-6.5) [fill=green!50] {5};
    \node[circle, draw, minimum size=0.7cm] (6) at (7,-6.5) [fill=green!50] {6};
    \node[circle, draw, minimum size=0.7cm] (7) at (3.5,-4.5) [fill=green!50] {7};
    \node[circle, draw, minimum size=0.7cm] (8) at (5, -3.5) [fill=green!50] {8};
    \node[circle, draw, minimum size=0.7cm] (9) at (6.5,-4.5) [fill=green!50] {9};
    \node[circle, draw, minimum size=0.7cm] (10) at (5,-1.5) [fill=green!50] {10};
    \node[circle, draw, minimum size=0.7cm] (11) at (1,-4) [fill=red!50] {11};
    \node[circle, draw, minimum size=0.7cm] (12) at (9,-4) [fill=blue!50] {12};
    \node[circle, draw, minimum size=0.7cm] (13) at (2, -3.5) [fill=red!50] {13};
    \node[circle, draw, minimum size=0.7cm] (14) at (8, -3.5) [fill=blue!50] {14};
    \node[circle, draw, minimum size=0.7cm] (15) at (2.5,-1) [fill=red!50] {15};
    \node[circle, draw, minimum size=0.7cm] (16) at (7.5,-1) [fill=blue!50] {16};
    \node[circle, draw, minimum size=0.7cm] (17) at (3,1) [fill=red!50] {17};
    \node[circle, draw, minimum size=0.7cm] (18) at (5,1.5) [fill=blue!50] {18};
    \node[circle, draw, minimum size=0.7cm] (19) at (7,1) [fill=blue!50] {19};
    \node[circle, draw, minimum size=0.7cm] (20) at (5,3) [fill=blue!50] {20};
    \foreach \source/\dest/\label/\xshiftval in {20/18//0, 18/17//0, 18/19//0, 17/15//0, 15/13/Cluster 2/-45, 13/11//0, 19/16//0, 16/14/Cluster 3/45, 14/12//0, 18/10//0, 10/8//0, 8/7//0, 7/5//0, 5/3/Cluster 1/-45, 3/1//0, 8/9//0, 9/6//0, 6/4//0, 4/2//0}
      \path (\source) edge node[xshift=\xshiftval] {\label} (\dest);
  \end{tikzpicture}
  \caption{Optimal color assignment to clusters at time \textit{t}}
  \label{fig:clust_t}
\end{figure}


\begin{figure}[H]
    \centering
    \begin{tikzpicture}
      \node[circle, draw, minimum size=0.3cm] (1) at (3.5,-1.25) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (2) at (6.5, -1.25) [fill=red!50] {};
      \node[circle, draw, minimum size=0.3cm] (3) at (4,-1) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (4) at (6, -1) [fill=red!50] {};
      \node[circle, draw, minimum size=0.3cm] (5) at (4.25,-0.5) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (6) at (5.75,-0.5) [fill=red!50] {};
      \node[circle, draw, minimum size=0.3cm] (7) at (4.5,0) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (8) at (5, 0.5) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (9) at (5.5,0) [fill=red!50] {};
      \node[circle, draw, minimum size=0.3cm] (10) at (5,1.25) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (11) at (3.2, 0.25) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (12) at (6.75,0.25) [fill=blue!50] {};
      \node[circle, draw, minimum size=0.3cm] (13) at (3.5, 0.75) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (14) at (6.5, 0.75) [fill=blue!50] {};
      \node[circle, draw, minimum size=0.3cm] (15) at (3.75,1.5) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (16) at (6.25,1.5) [fill=blue!50] {};
      \node[circle, draw, minimum size=0.3cm] (17) at (4.25,2) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (18) at (5,2.25) [fill=green!50] {};
      \node[circle, draw, minimum size=0.3cm] (19) at (5.75,2) [fill=blue!50] {};
      \node[circle, draw, minimum size=0.3cm] (20) at (5,3) [fill=green!50] {};  
      \foreach \source/\dest/\label/\xshiftval in {20/18//0, 18/17//0, 18/19//0, 17/15//0, 15/13//-45, 13/11//0, 19/16//0, 16/14/Cluster 6/45, 14/12//0, 18/10//0, 10/8//0, 8/7//0, 7/5//0, 5/3/Cluster 4/-45, 3/1//0, 8/9//0, 9/6//0, 6/4/Cluster 5/45, 4/2//0}
        \path (\source) edge node[xshift=\xshiftval] {\label} (\dest);
    \end{tikzpicture}
      \caption{Color assignment to clusters at time \textit{t+1} obtained from clustering}
      \label{fig:clust_tplus1}
\end{figure}

\begin{figure}[H]
  \centering
  \begin{subfigure}{0.3\textwidth}
    \centering
    \begin{tikzpicture}[every node/.style={circle, draw, minimum size=0.1cm}]
      \node (1) at (3.5,-1.25) [fill=green!50] {};
      \node (2) at (6.5, -1.25) [fill=red!50] {};
      \node (3) at (4,-1) [fill=green!50] {};
      \node (4) at (6, -1) [fill=red!50] {};
      \node (5) at (4.25,-0.5) [fill=green!50] {};
      \node (6) at (5.75,-0.5) [fill=red!50] {};
      \node (7) at (4.5,0) [fill=green!50] {};
      \node (8) at (5, 0.5) [fill=green!50] {};
      \node (9) at (5.5,0) [fill=red!50] {};
      \node (10) at (5,1.25) [fill=green!50] {};
      \node (11) at (3.2, 0.25) [fill=green!50] {};
      \node (12) at (6.75,0.25) [fill=blue!50] {};
      \node (13) at (3.5, 0.75) [fill=green!50] {};
      \node (14) at (6.5, 0.75) [fill=blue!50] {};
      \node (15) at (3.75,1.5) [fill=green!50] {};
      \node (16) at (6.25,1.5) [fill=blue!50] {};
      \node (17) at (4.25,2) [fill=green!50] {};
      \node (18) at (5,2.25) [fill=green!50] {};
      \node (19) at (5.75,2) [fill=blue!50] {};
      \node (20) at (5,3) [fill=green!50] {};  
      \foreach \source/\dest in {20/18, 18/17, 18/19, 17/15, 15/13, 13/11, 19/16, 16/14, 14/12, 18/10, 10/8, 8/7, 7/5, 5/3, 3/1, 8/9, 9/6, 6/4, 4/2}
        \path (\source) edge (\dest);
    \end{tikzpicture}
      \caption{}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
    \centering
    \begin{tikzpicture}[every node/.style={circle, draw, minimum size=0.1cm}]
      \node (1) at (3.5,-1.25) [fill=green!50] {};
      \node (2) at (6.5, -1.25) [fill=blue!50] {};
      \node (3) at (4,-1) [fill=green!50] {};
      \node (4) at (6, -1) [fill=blue!50] {};
      \node (5) at (4.25,-0.5) [fill=green!50] {};
      \node (6) at (5.75,-0.5) [fill=blue!50] {};
      \node (7) at (4.5,0) [fill=green!50] {};
      \node (8) at (5, 0.5) [fill=green!50] {};
      \node (9) at (5.5,0) [fill=blue!50] {};
      \node (10) at (5,1.25) [fill=green!50] {};
      \node (11) at (3.2, 0.25) [fill=green!50] {};
      \node (12) at (6.75,0.25) [fill=red!50] {};
      \node (13) at (3.5, 0.75) [fill=green!50] {};
      \node (14) at (6.5, 0.75) [fill=red!50] {};
      \node (15) at (3.75,1.5) [fill=green!50] {};
      \node (16) at (6.25,1.5) [fill=red!50] {};
      \node (17) at (4.25,2) [fill=green!50] {};
      \node (18) at (5,2.25) [fill=green!50] {};
      \node (19) at (5.75,2) [fill=red!50] {};
      \node (20) at (5,3) [fill=green!50] {};  
      \foreach \source/\dest in {20/18, 18/17, 18/19, 17/15, 15/13, 13/11, 19/16, 16/14, 14/12, 18/10, 10/8, 8/7, 7/5, 5/3, 3/1, 8/9, 9/6, 6/4, 4/2}
        \path (\source) edge (\dest);
    \end{tikzpicture}
      \caption{}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
    \centering
    \begin{tikzpicture}[every node/.style={circle, draw, minimum size=0.1cm}]
      \node (1) at (3.5,-1.25) [fill=blue!50] {};
      \node (2) at (6.5, -1.25) [fill=red!50] {};
      \node (3) at (4,-1) [fill=blue!50] {};
      \node (4) at (6, -1) [fill=red!50] {};
      \node (5) at (4.25,-0.5) [fill=blue!50] {};
      \node (6) at (5.75,-0.5) [fill=red!50] {};
      \node (7) at (4.5,0) [fill=blue!50] {};
      \node (8) at (5, 0.5) [fill=blue!50] {};
      \node (9) at (5.5,0) [fill=red!50] {};
      \node (10) at (5,1.25) [fill=blue!50] {};
      \node (11) at (3.2, 0.25) [fill=blue!50] {};
      \node (12) at (6.75,0.25) [fill=green!50] {};
      \node (13) at (3.5, 0.75) [fill=blue!50] {};
      \node (14) at (6.5, 0.75) [fill=green!50] {};
      \node (15) at (3.75,1.5) [fill=blue!50] {};
      \node (16) at (6.25,1.5) [fill=green!50] {};
      \node (17) at (4.25,2) [fill=blue!50] {};
      \node (18) at (5,2.25) [fill=blue!50] {};
      \node (19) at (5.75,2) [fill=green!50] {};
      \node (20) at (5,3) [fill=blue!50] {};  
      \foreach \source/\dest in {20/18, 18/17, 18/19, 17/15, 15/13, 13/11, 19/16, 16/14, 14/12, 18/10, 10/8, 8/7, 7/5, 5/3, 3/1, 8/9, 9/6, 6/4, 4/2}
        \path (\source) edge (\dest);
    \end{tikzpicture}
      \caption{}
  \end{subfigure}
  
  \vspace{1cm} % Spazio vuoto tra le righe
  
  \begin{subfigure}{0.3\textwidth}
    \centering
    \begin{tikzpicture}[every node/.style={circle, draw, minimum size=0.1cm}]
      \node (1) at (3.5,-1.25) [fill=blue!50] {};
      \node (2) at (6.5, -1.25) [fill=green!50] {};
      \node (3) at (4,-1) [fill=blue!50] {};
      \node (4) at (6, -1) [fill=green!50] {};
      \node (5) at (4.25,-0.5) [fill=blue!50] {};
      \node (6) at (5.75,-0.5) [fill=green!50] {};
      \node (7) at (4.5,0) [fill=blue!50] {};
      \node (8) at (5, 0.5) [fill=blue!50] {};
      \node (9) at (5.5,0) [fill=green!50] {};
      \node (10) at (5,1.25) [fill=blue!50] {};
      \node (11) at (3.2, 0.25) [fill=blue!50] {};
      \node (12) at (6.75,0.25) [fill=red!50] {};
      \node (13) at (3.5, 0.75) [fill=blue!50] {};
      \node (14) at (6.5, 0.75) [fill=red!50] {};
      \node (15) at (3.75,1.5) [fill=blue!50] {};
      \node (16) at (6.25,1.5) [fill=red!50] {};
      \node (17) at (4.25,2) [fill=blue!50] {};
      \node (18) at (5,2.25) [fill=blue!50] {};
      \node (19) at (5.75,2) [fill=red!50] {};
      \node (20) at (5,3) [fill=blue!50] {};  
      \foreach \source/\dest in {20/18, 18/17, 18/19, 17/15, 15/13, 13/11, 19/16, 16/14, 14/12, 18/10, 10/8, 8/7, 7/5, 5/3, 3/1, 8/9, 9/6, 6/4, 4/2}
        \path (\source) edge (\dest);
    \end{tikzpicture}
      \caption{}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
    \centering
    \begin{tikzpicture}[every node/.style={circle, draw, minimum size=0.1cm}]
      \node (1) at (3.5,-1.25) [fill=red!50] {};
      \node (2) at (6.5, -1.25) [fill=green!50] {};
      \node (3) at (4,-1) [fill=red!50] {};
      \node (4) at (6, -1) [fill=green!50] {};
      \node (5) at (4.25,-0.5) [fill=red!50] {};
      \node (6) at (5.75,-0.5) [fill=green!50] {};
      \node (7) at (4.5,0) [fill=red!50] {};
      \node (8) at (5, 0.5) [fill=red!50] {};
      \node (9) at (5.5,0) [fill=green!50] {};
      \node (10) at (5,1.25) [fill=red!50] {};
      \node (11) at (3.2, 0.25) [fill=red!50] {};
      \node (12) at (6.75,0.25) [fill=blue!50] {};
      \node (13) at (3.5, 0.75) [fill=red!50] {};
      \node (14) at (6.5, 0.75) [fill=blue!50] {};
      \node (15) at (3.75,1.5) [fill=red!50] {};
      \node (16) at (6.25,1.5) [fill=blue!50] {};
      \node (17) at (4.25,2) [fill=red!50] {};
      \node (18) at (5,2.25) [fill=red!50] {};
      \node (19) at (5.75,2) [fill=blue!50] {};
      \node (20) at (5,3) [fill=red!50] {};  
      \foreach \source/\dest in {20/18, 18/17, 18/19, 17/15, 15/13, 13/11, 19/16, 16/14, 14/12, 18/10, 10/8, 8/7, 7/5, 5/3, 3/1, 8/9, 9/6, 6/4, 4/2}
        \path (\source) edge (\dest);
    \end{tikzpicture}
      \caption{}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
    \centering
    \begin{tikzpicture}[every node/.style={circle, draw, minimum size=0.1cm}]
      \node (1) at (3.5,-1.25) [fill=red!50] {};
      \node (2) at (6.5, -1.25) [fill=blue!50] {};
      \node (3) at (4,-1) [fill=red!50] {};
      \node (4) at (6, -1) [fill=blue!50] {};
      \node (5) at (4.25,-0.5) [fill=red!50] {};
      \node (6) at (5.75,-0.5) [fill=blue!50] {};
      \node (7) at (4.5,0) [fill=red!50] {};
      \node (8) at (5, 0.5) [fill=red!50] {};
      \node (9) at (5.5,0) [fill=blue!50] {};
      \node (10) at (5,1.25) [fill=red!50] {};
      \node (11) at (3.2, 0.25) [fill=red!50] {};
      \node (12) at (6.75,0.25) [fill=green!50] {};
      \node (13) at (3.5, 0.75) [fill=red!50] {};
      \node (14) at (6.5, 0.75) [fill=green!50] {};
      \node (15) at (3.75,1.5) [fill=red!50] {};
      \node (16) at (6.25,1.5) [fill=green!50] {};
      \node (17) at (4.25,2) [fill=red!50] {};
      \node (18) at (5,2.25) [fill=red!50] {};
      \node (19) at (5.75,2) [fill=green!50] {};
      \node (20) at (5,3) [fill=red!50] {};  
      \foreach \source/\dest in {20/18, 18/17, 18/19, 17/15, 15/13, 13/11, 19/16, 16/14, 14/12, 18/10, 10/8, 8/7, 7/5, 5/3, 3/1, 8/9, 9/6, 6/4, 4/2}
        \path (\source) edge (\dest);
    \end{tikzpicture}
      \caption{}
  \end{subfigure}

  \vspace{0.5cm} % Spazio vuoto tra le righe
  
  \caption{Possible color assignments at time \textit{t+1}}
  \label{fig:clust_ass}
\end{figure}



\begin{table}[H]
  \centering
  \begin{tabular}{|c|c|c|c|c|}
    \hline
   \textbf{Assignment} & \textbf{Red match} & \textbf{Blue match} & \textbf{Green match} & \textbf{Utility Value} \\
    \hline
    (a) & 0 & 4 & 6 & 10 \\
    \hline
    (b) & 0 & 0 & 6 & 6 \\
    \hline
    (c) & 0 & 2 & 0 & 2 \\
    \hline
    (d) & 0 & 2 & 4 & 6 \\
    \hline
    (e) & 4 & 4 & 4 & 12 \\
    \hline
    (f) & 4 & 0 & 0 & 4 \\
    \hline
  \end{tabular}
  
  \vspace{0.5cm} % Spazio vuoto tra le righe
  
  \caption{Matching weights for the 6 assignments}
  \label{tab:table_clust}
\end{table}
 
From Table \ref{tab:table_clust}, it can be observed that assignment (e) has the highest utility value.
Additionally, even visually, it can be noticed that it is the most consistent assignment compared to the one at time \textit{t}.
\\

From the perspective of Bipartite Matching, we can consider the clusters from Figure \ref{fig:clust_t} in the first partition, while in the second partition, we can consider the clusters from Figure \ref{fig:clust_tplus1}.
As mentioned earlier, the weight of an edge is equivalent to the number of nodes that the two clusters being connected by that edge have in common. \\
The following figure shows the matching with the utility value for every possible assignment and the colored ones for the optimal one.

\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[circle, draw, minimum size=1cm, fill=green!50] (1) at (2,-6.5) {Cluster 1};
    \node[circle, draw, minimum size=1cm, fill=red!50] (2) at (2, -10) {Cluster 2};
    \node[circle, draw, minimum size=1cm, fill=blue!50] (3) at (2,-13.5) {Cluster 3};
    \node[circle, draw, minimum size=1cm, fill=red!50] (4) at (8, -6.5) {Cluster 4};
    \node[circle, draw, minimum size=1cm, fill=green!50] (5) at (8,-10) {Cluster 5};
    \node[circle, draw, minimum size=1cm, fill=blue!50] (6) at (8,-13.5) {Cluster 6};
    
    \foreach \source/\dest/\label/\position/\yshiftval/\xshiftval/\edgecolor in {
      1/4/6/above/0/0/black, 1/5/4/above/25/-40/green, 1/6/0/above/60/-70/black,
      2/4/4/below/-15/-60/red, 2/5/0/below/0/-40/black, 2/6/0/below/30/-60/black,
      3/4/2/below/-60/-70/black, 3/5/0/below/-25/-40/black, 3/6/4/below/0/0/blue}
      \path (\source) edge[\edgecolor, ->,>=stealth, line width=0.5pt] node[\position, yshift=\yshiftval, xshift=\xshiftval, black] {\label} (\dest);
  \end{tikzpicture}
  \caption{Bipartite Matching from instant \textit{t} to instant \textit{t+1}}
  \label{fig:clust_match}
\end{figure}



\section{Brute Force Algorithm}
The BF can be a possible approach to solve the MPWM problem for bipartite graphs.
However, it's important to note that the BF has exponential time complexity, specifically, its time complexity grows exponentially with the number of vertices in the graph.
This is because the BF examines all possible combinations of perfect matchings within the bipartite graph to find the one with the maximum weight.\\
If the graph has \textit{n} vertices in both the first and second partitions, there are \textit{n}!\ possible matchings.
Each matching requires \textit{O}(\textit{n}) time to be computed because you need to check that it is a perfect matching and calculate its total weight.
Therefore, the overall complexity of the algorithm is on the order of \textit{O}(\textit{n}!$\cdot$\textit{n}). \\
Since the complexity grows rapidly as \textit{n} increases, it quickly becomes impractical for large-sized graphs. However, for our case, this is not a problem.

A MPWM problem using an utility matrix can be transformed into a minimum-weight matching problem.
This can be achieved by introducing an auxiliary matrix, referred to as the \textit{cost matrix}.
The cost matrix is essentially a duplicate of the utility matrix, but with all its elements negated.

\subsection{Brute Force Algorithm summarized}
The operation of the BF for minimum-weight matching problems can be summerized in these 3 steps:

\begin{enumerate}
    \item {Compute the cost matrix for the considered bipartite graph with \textit{n} vertices in each partition.}
    \item {Compute the total cost of all the \textit{n}!\ permutations.}
    \item {Choose the assignment with the lowest total cost.}
\end{enumerate}


\subsection{Brute Force Algorithm application}

Let's take for example the following cost matrix and try to apply the BF for minimum-weight matching problems:

\begin{table}[H]
    \centering
    \begin{tabular}{|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|}
      \hline
      108 & 125 & 150 \\
      \hline
      150 & 135 & 175 \\
      \hline
      122 & 148 & 250 \\
      \hline
    \end{tabular}
    \end{table}

Now we compute the total cost of all the \textit{n}!\ permutations: 
  

  \begin{table}[H]
    \begin{minipage}[b]{0.3\textwidth}
        \centering
        \begin{tabular}{|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|}
            \hline
            \cellcolor{yellow!25} 108 & 125 & 150 \\
            \hline
            150 & \cellcolor{yellow!25} 135 & 175 \\
            \hline
            \cellcolor{yellow!25} 122 & 148 & 250 \\
            \hline
        \end{tabular}
        \caption*{(a)}
        \label{tab:perm1}
    \end{minipage}
    \hfill
    \begin{minipage}[b]{0.3\textwidth}
        \centering
        \begin{tabular}{|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|}
            \hline
            108 & \cellcolor{yellow!25} 125 & 150 \\
            \hline
            \cellcolor{yellow!25} 150 & 135 & 175 \\
            \hline
            122 & 148 & \cellcolor{yellow!25} 250 \\
            \hline
        \end{tabular}
        \caption*{(b)}
        \label{tab:perm2}
    \end{minipage}
    \hfill
    \begin{minipage}[b]{0.3\textwidth}
        \centering
        \begin{tabular}{|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|}
            \hline
            108 & 125 & \cellcolor{yellow!25} 150 \\
            \hline
            150 & \cellcolor{yellow!25} 135 & 175 \\
            \hline
            \cellcolor{yellow!25} 122 & 148 & 250 \\
            \hline
        \end{tabular}
        \caption*{(c)}
        \label{tab:perm3}
    \end{minipage}
\end{table}

\begin{table}[H]
    \begin{minipage}[b]{0.3\textwidth}
        \centering
        \begin{tabular}{|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|}
            \hline
            \cellcolor{yellow!25} 108 & 125 & 150 \\
            \hline
            150 & \cellcolor{yellow!25} 135 & 175 \\
            \hline
            \cellcolor{yellow!25} 122 & 148 & 250 \\
            \hline
        \end{tabular}
        \caption*{(d)}
        \label{tab:perm4}
    \end{minipage}
    \hfill
    \begin{minipage}[b]{0.3\textwidth}
        \centering
        \begin{tabular}{|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|}
            \hline
            108 & \cellcolor{yellow!25} 125 & 150 \\
            \hline
            \cellcolor{yellow!25} 150 & 135 & 175 \\
            \hline
            122 & 148 & \cellcolor{yellow!25} 250 \\
            \hline
        \end{tabular}
        \caption*{(e)}
        \label{tab:perm5}
    \end{minipage}
    \hfill
    \begin{minipage}[b]{0.3\textwidth}
        \centering
        \begin{tabular}{|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|>{\centering\arraybackslash}m{0.6cm}|}
            \hline
            108 & 125 & \cellcolor{yellow!25} 150 \\
            \hline
            \cellcolor{yellow!25} 150 & 135 & 175 \\
            \hline
            122 & \cellcolor{yellow!25} 148 & 250 \\
            \hline
        \end{tabular}
        \caption{(f)}
        \label{tab:perm6}
    \end{minipage}
\caption{BF assignements}
\label{tab:tab_ass}
\end{table}
 

\begin{table}[H]
  \centering
  \begin{tabular}{|c|c|c|c|c|}
    \hline
   \textbf{Assignment} & \textbf{Total weight} \\
    \hline
    (a) & 493 \\
    \hline
    (b) & 422 \\
    \hline
    (c) & 448 \\
    \hline
    (d) & 407 \\
    \hline
    (e) & 525 \\
    \hline
    (f) & 431 \\
    \hline
  \end{tabular}
  
  \vspace{0.5cm} % Spazio vuoto tra le righe
  
  \caption{Total weights for the 6 assignments}
  \label{tab:table_costs}
\end{table}

We find that the minimum total cost is given by the assignment (d) in Table \ref{tab:tab_ass}.  

